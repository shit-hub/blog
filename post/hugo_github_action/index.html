<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=generator content="Hugo 0.61.0"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Hugo + Github Action - SH IT Blog</title><meta property="og:title" content="Hugo + Github Action - SH IT Blog"><meta property="og:type" content="article"><meta property="article:published_time" content="2020-05-27T20:28:43+08:00"><meta property="article:modified_time" content="2020-05-27T20:28:43+08:00"><meta name=description content="The course about how to build blog by hugo and github action"><meta name=author content="Sanjo Heron"><meta property="og:url" content="https://blog.shit-hub.com/post/hugo_github_action/"><link rel=stylesheet href=/css/normalize.css><link rel=stylesheet href=/css/prism.css><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/style.extra.css></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><a id=logo href=https://blog.shit-hub.com>SH IT Blog</a></div><div><nav id=nav-menu class=clearfix><a class=current href=https://blog.shit-hub.com>Home</a>
<a href=https://blog.shit-hub.com/categories/ title=Categories>Categories</a>
<a href=https://blog.shit-hub.com/tags/ title=Tags>Tags</a>
<a href=https://blog.shit-hub.com/archives/ title=Archives>Archives</a>
<a href=https://blog.shit-hub.com/about/ title=About>About</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>Hugo + Github Action</h1></header><date class="post-meta meta-date">2020.5.27
20:28</date><div class="post-meta meta-category">，Classed as
<a href=/categories/blog>Blog</a></div><aside id=toc class=dismissed><span class=toc-title>Directory <a href=# class=toc-dismiss></a></span><nav id=TableOfContents><ul><li><a href=#hugo>hugo安装</a><ul><li><a href=#heading>下载二进制文件</a></li><li><a href=#pathhugo--github-action>解压到PATH路径hugo + github action</a></li></ul></li><li><a href=#github>github配置</a></li><li><a href=#heading-1>生成博客</a><ul><li><a href=#heading-2>初始化网站</a></li><li><a href=#heading-3>主题配置</a></li></ul></li><li><a href=#github-action>配置Github Action</a><ul><li><a href=#heading-4>生成密钥对</a></li><li><a href=#heading-5>配置项目</a></li><li><a href=#action>制定Action</a></li></ul></li><li><a href=#heading-6>测试</a></li></ul></nav></aside><div class=post-content><h2 id=hugo>hugo安装</h2><h3 id=heading>下载二进制文件</h3><p>到<a href=https://github.com/gohugoio/hugo/releases>Hugo官网</a>选取对应的二进制包；以0.71.1版本为例：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>wget https://github.com/gohugoio/hugo/releases/download/v0.71.1/hugo_0.71.1_Linux-64bit.tar.gz
</code></pre></div><h3 id=pathhugo--github-action>解压到PATH路径hugo + github action</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>tar zxvf hugo_0.71.1_Linux-64bit.tar.gz -C /usr/bin hugo
</code></pre></div><h2 id=github>github配置</h2><p>在github上创建名为blog的仓库，然后下载到本地</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>git clone https://github.com/&lt;username&gt;/blog.git
</code></pre></div><p>切换到存储hugo源码的分支</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>git checkout -b hugo
</code></pre></div><h2 id=heading-1>生成博客</h2><h3 id=heading-2>初始化网站</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>cd blog
<span style=color:#75715e># 由于当前目录已存在.git文件夹，需要添加--force强制生成</span>
hugo new site . --force
</code></pre></div><blockquote><p>建议这里提交一次修改</p></blockquote><h3 id=heading-3>主题配置</h3><p>到(hugo theme)[<a href=https://themes.gohugo.io/>https://themes.gohugo.io/</a>]选取主题，然后按照主题指示安装配置， 以maupassant为例</p><ol><li>下载主题</li></ol><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>git submodule add https://github.com/shit-hub/maupassant-hugo.git themes/maupassant-hugo
</code></pre></div><ol start=2><li>配置config.toml</li></ol><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml>baseURL = <span style=color:#e6db74>&#34;https://blog.shit-hub.com&#34;</span>
languageCode = <span style=color:#e6db74>&#34;zh-CN&#34;</span>
title = <span style=color:#e6db74>&#34;SH IT Blog&#34;</span>
hasCJKLanguage = <span style=color:#66d9ef>true</span>
theme = <span style=color:#e6db74>&#34;maupassant-hugo&#34;</span>
enableRobotsTXT = <span style=color:#66d9ef>true</span>
PaginatePath = <span style=color:#e6db74>&#34;page&#34;</span>

[author]
    name = <span style=color:#e6db74>&#34;Sanjo Heron&#34;</span>
    homepage = <span style=color:#e6db74>&#34;https://www.shit-hub.com&#34;</span>

[params]
    subtitle = <span style=color:#e6db74>&#34;&#34;</span>
    description = <span style=color:#e6db74>&#34;&#34;</span>
    keywords = <span style=color:#e6db74>&#34;Blog&#34;</span>

    customCSS = [<span style=color:#e6db74>&#34;style.extra.css&#34;</span>]
    customJS = [<span style=color:#e6db74>&#34;app.extra.js&#34;</span>]

[params.utteranc]
    repo = <span style=color:#e6db74>&#34;JokerQyou/comments&#34;</span>
    issueTerm = <span style=color:#e6db74>&#34;url&#34;</span>
    theme = <span style=color:#e6db74>&#34;github-light&#34;</span>

[[menu.main]]
    identifier = <span style=color:#e6db74>&#34;categories&#34;</span>
    name = <span style=color:#e6db74>&#34;Categories&#34;</span>
    url = <span style=color:#e6db74>&#34;/categories/&#34;</span>
    weight = <span style=color:#ae81ff>1</span>

[[menu.main]]
    identifier = <span style=color:#e6db74>&#34;tags&#34;</span>
    name = <span style=color:#e6db74>&#34;Tags&#34;</span>
    url = <span style=color:#e6db74>&#34;/tags/&#34;</span>
    weight = <span style=color:#ae81ff>2</span>

[[menu.main]]
    identifier = <span style=color:#e6db74>&#34;archives&#34;</span>
    name = <span style=color:#e6db74>&#34;Archives&#34;</span>
    url = <span style=color:#e6db74>&#34;/archives/&#34;</span>
    weight = <span style=color:#ae81ff>3</span>

[[menu.main]]
    identifier = <span style=color:#e6db74>&#34;about&#34;</span>
    name = <span style=color:#e6db74>&#34;About&#34;</span>
    url = <span style=color:#e6db74>&#34;/about/&#34;</span>
    weight = <span style=color:#ae81ff>4</span>
</code></pre></div><blockquote><p>可调用<code>hugo server</code>命令，然后访问localhost:1313即可预览，建议预览满意后提交一次修改</p></blockquote><h2 id=github-action>配置Github Action</h2><h3 id=heading-4>生成密钥对</h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>ssh-keygen -t rsa -b <span style=color:#ae81ff>4096</span> -C <span style=color:#e6db74>&#34;your_email&#34;</span> -f gh-pages -N <span style=color:#e6db74>&#34;&#34;</span>
</code></pre></div><h3 id=heading-5>配置项目</h3><ol><li>在 GitHub 网站中打开项目的设置页面</li><li>将刚生成的 ssh 公钥（gh-pages.pub）添加到 Deploy Keys 并选择 Allow write access</li><li>将私钥添加到 Secrets，命名为 ACTIONS_DEPLOY_KEY</li></ol><h3 id=action>制定Action</h3><p>打开项目中的Action，添加新的workflow，添加以下代码</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml>name: github pages

on:
  push:
    branches:
      - hugo

jobs:
  build-deploy:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v1
      with:
        submodules: <span style=color:#66d9ef>true</span>

    - name: Setup Hugo
      uses: peaceiris/actions-hugo@v2<span style=color:#ae81ff>.3</span><span style=color:#ae81ff>.1</span>
      with:
        hugo-version: <span style=color:#e6db74>&#39;0.61.0&#39;</span>

    - name: Build
      run: hugo --minify

    - name: add nojekyll
      run: touch ./public/.nojekyll

    - name: Deploy
      uses: peaceiris/actions-gh-pages@v2<span style=color:#ae81ff>.5</span><span style=color:#ae81ff>.1</span>
      env:
        ACTIONS_DEPLOY_KEY: ${{ secrets.ACTIONS_DEPLOY_KEY }}
        PUBLISH_BRANCH: master
        PUBLISH_DIR: ./public
</code></pre></div><h2 id=heading-6>测试</h2><p>提交本地修改测试是否成功</p></div><div class="post-meta meta-tags"><ul class=clearfix><li><a href=/tags/hugo>Hugo</a></li></ul></div></article><div id=comments><span class=widget-title>Comment Closed</span></div></div></div><div id=secondary><section class=widget><form id=search method=post action=https://duckduckgo.com/><input type=text name=q maxlength=255 placeholder=Search...>
<input type=hidden name=sites value=https://blog.shit-hub.com>
<input type=hidden name=kp value=-2>
<input type=hidden name=kh value=1>
<input type=hidden name=kl value=wt-wt>
<input type=hidden name=kg value=p>
<input type=hidden name=kaf value=1>
<input type=hidden name=k1 value=-1>
<input type=hidden name=k7 value=#ffffff>
<input type=hidden name=kj value=#ffffff>
<input type=hidden name=ky value=#eaeaea>
<input type=hidden name=kx value=#6E7173>
<input type=hidden name=k8 value=#444>
<input type=hidden name=k9 value=#6E7173>
<input type=hidden name=kaa value=#6E7173>
<input type=hidden name=kae value=#6E7173>
<input type=hidden name=ko value=1>
<input type=hidden name=kt value=n>
<input type=hidden name=ka value=g>
<input type=hidden name=ks value=l>
<input type=hidden name=kv value=1>
<button type=submit class="submit icon-search"></button></form></section><section class=widget><h3 class=widget-title>Categories</h3><ul class=widget-list><li><a href=/categories/blog>blog (1)</a></li></ul></section><section class=widget><h3 class=widget-title>Other</h3><ul class=widget-list><li><a href=/index.xml>RSS</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a rel=nofollow href=https://blog.shit-hub.com>SH IT Blog</a>.
Powered by <a rel="nofollow noreferer noopener" href=https://gohugo.io>Hugo</a>.
<a rel="nofollow noreferer noopener" href=https://github.com/JokerQyou/maupassant-hugo>Theme</a> based on <a rel="nofollow noreferer noopener" href=https://github.com/pagecho/maupassant>maupassant</a>.</div></footer><script type=text/javascript src=/js/prism.js async></script><script type=text/javascript src=/js/app.js defer></script><script type=text/javascript src=/js/app.extra.js defer></script><script type=text/javascript src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" defer></script></body></html>